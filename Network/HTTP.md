# HTTP
간략하게 정리. 다 정리해보고나서 책을 더 사서 읽어보고 추가로 정리해봐야겠다. 

```
< 추가로 읽어볼 책 >
그림으로 공부하는 TCP/IP
IT엔지니어를 위한 네트워크 입문
리얼월드 HTTP
HTTP 완벽가이드
```

- OSI 7계층
- 인터넷 네트워크
	- 인터넷  통신
		- 클라이언트 - 인터넷 - 서버
		- 인터넷 프로토콜(Internet Protocol, IP)의 역할 : 부여받은 IP 주소로 패킷(Packet)이라는 통신 단위로 데이터를 전달 
		- IP 패킷 정보 구성(출발지 주소, 목적지 주소, 데이터...)하여 클라이언트가 요청하고 서버가 응답을 보낸다.
		- IP 프로토콜의 한계 
			- 비연결성 : 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷을 전송한다.
			- 비신뢰성 : 중간에 패킷이 사라질 수 있고 그 사실을 모른다. 패킷이 순서대로 오지 않을 수도 있다. 
			- 프로그램 구분 못함 : 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상일 경우 IP주소만으로는 구분할 수 없는 한계
	
	- 인터넷 프로토콜 스택의 4계층
		- 애플리케이션 계층 : HTTP, FTP 
		- 전송 계층: TCP, UDP			 	
		- 인터넷 계층: IP						
		- 네트워크 인터페이스 계층: 이더넷 프레임
		
		```text
		1. 프로그램에서 메시지 데이터 작성.(애플리케이션)
		2. SOCKET 라이브러리를 통해 전달.(애플리케이션)
		3. 메시지 데이터를 포함시킨 TCP 정보 생성한다.(OS)
		4. TCP 정보를 포함시킨 IP패킷 생성한다.(OS)
		5. 생성된 패킷이 랜카드와 인터넷을 거쳐 서버에 도착.(네트워크 인터페이스) 
		```
	- TCP (Transmission Control Protocol) 전송제어 프로토콜:  출발지 포트, 목적지 포트, 전송 제어, 순서, 검증
		- TCP 특징
		- 연결지향 - TCP 3 way handshake(논리적 연결) : 먼저 연결을 한 뒤에 메시지를 보낸다. 
			- SYN : 접속 요청, ACK: 요청 수락 : 미리 연결을 확보  
		- 데이터 전달 보증 : 패킷이 누락되면 알 수 있다. 
			- 서버로 데이터 전송 후 서버에서 잘 받았다고 응답.
		- 순서 보장
			- 패킷이 잘못된 순서로 도착하면 제대로 된 순서로 다시 보내라고 서버에서 클라이언트에게 재요청
	- UDP (User Datagram Protocol, 사용자 데이터그램 프로토콜)
		- 데이터 전달 및 순서가 보장되지 않음. 단순하지만 빠름. 
		- IP와 거의 같고 PORT나 체크섬 정도만 추가.
		- 그래서 애플리케이션에서 추가 작업 필요.

	- PORT
		- PORT로 같은 IP 내에서 프로세스 구분
		- 0 ~ 65535 할당 가능
		- 0 ~ 1023 이미 사용중인 포트가 많으므로 사용하지 않는 게 좋다.
			- FTP - 20, 21
			- TELNET - 23
			- HTTP - 80
			- HTTPS - 443

	- DNS (Domain Name System)
		- IP는 사람이 기억하기 어렵고 IP 자체가 변경될 수 있어서 전화번호부처럼 DNS가 도메인 명을 IP주소로 변환
	- URI (Uniform Resource Identifier) https://www.ietf.org/rfc/rfc3986.txt
		- Uniform : 리소스를 식별하는 통일된 방식
		- Resource : URI로 식별할 수 있는 모든 자원
		- Identifier : 다른 항목과 구분하는데 필요한 정보
		- URI는 Locaoter , Name 으로 추가로 분류(URL, URN)
			- URL : 리소스가 있는 위치를 지정 
			- URN: 리소스에 이름을 부여
		- URL
			- 프로토콜, 호스트명, 포트번호, 패스, 쿼리파라미터
			- 프로토콜 : 어떤 방식으로 자원에 접근할 것인가 하는 약속, 규칙
			- 호스트명: 도메인명이나 IP주소 직접 입력해서 사용
			- 포트: 80, 443 생략
			- 패스: 계층적 구조
			- 쿼리: ?로 시작, &로 추가 가능, 모두 문자형태  (쿼리파라미터, 쿼리스트링) 
			- fragment : [# fragment ] html 내부 북마크 등에서 사용. 서버에 전송하는 정보는 아님

	- 웹 브라우저 요청흐름 
		1. DNS 조회하여 IP 주소 및 포트 정보 확인
		2. 브라우저가 HTTP 요청 메시지 생성 (GET , 패스 정보, HTTP 버전 정보, 호스트 정보...)
		3. SOCKET 라이브러리를 통해 TCP/IP 계층으로 전달
			- TCP/IP 연결 확립
			- 연결 확인 후 TCP/IP 계층으로 데이터 전달
		4. HTTP 메시지를 포함하여 TCP/IP 패킷 생성
		5. 랜카드와 인터넷을 거쳐 서버에 전달
		6. 서버는 HTTP 응답 메시지를 작성하여 클라이언트에게 전달
		7. 클라이언트 측의 웹 브라우저는 받은 결과를 렌더링하여 화면에 표시한다.