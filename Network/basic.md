# 네트워크 기초
천천히 읽으며 복습도 하고 그림을 그려보자. 

## 기초
- 네트워크: 노드와 링크가 서로 연결되어 있거나 연결되어 있지 않은 집합체
- 처리량(throughput): 링크를 통해 전달되는 단위 시간당 데이터 양, 단위 bps
- 대역폭: 주어진 시간동안 네트워크 연결을 통해 흐를 수 있는 최대 비트 수 
- 지연 시간(latency): 요청이 처리되는 시간. 어떤 메시지가 두 장치 사이를 왕복하는데 걸린 시간

## 기본 흐름
네트워크 시스템을 통해 컴퓨터 간에 온라인으로 실시간으로 다양한 정보를 주고 받을 수 있다. 컴퓨터와 컴퓨터를 연결해서 다양하고 새로운 가치를 창출할 수 있다.

- LAN : 가정이나 사무실등 하나의 거점 내부를 연결하는 네트워크
	- 클라이언트(유선랜) - 스위치 - 라우터 - ONU - 인터넷
	- 클라이언트(무선랜) ---#전파#--- 라우터 - ONU - 인터넷  
	- LAN의 규격 : 점점 새로운 규격으로 바뀌면서 빠르고 저렴해짐. 
		- 유선LAN : 이더넷:랜에 이용되는 물리적인 회선이나 접속 커넥터에관해 정해진 규격( OSI 7계층의 1, 2층) 
		- 무선LAN : IEEE 802.11 시리즈, Wi-Fi Alicance 단체가 이 표준에 따라 만들어진 제품간 호환성을 인증(Wi-Fi 인증)함. 
- WAN : 거점과 거점, 거점과 인터넷을 연결하는 네트워크. 통신사업자가 제공하는 통신 회선 서비스를 이용하며, 통신사업자의 설비를 빌려야 하므로 통신 서비스 이용료를 지불해야한다. 
	- 유선 WAN 
	- 무선 WAN : 휴대전화 
- 네트워크 구성요소 
	- ***스위치*** : 유선랜을 묶는다. 랜 케이블을 모으는 장치로, 조건에 맞게 통신을 중계한다. 
		- L2 스위치 : 단순히 유선랜을 묶는다. 이더넷 범위에서 처리
		- L3 스위치 : 네트워크와 네트워크를 연결하는 기능이 있다. 라우팅이 가능함.
		- L4 스위치(L7) : 부하 분산 및 애플리케이션에 맞게 통신을 제어할 수 있는 고급 스위치. TCP로 및 응용프로그램레벨에서 배분 
	- ***무선 액세스 포인트*** : 무선 랜을 묶고 유선랜과 중개도 한다. 공유기와 함께 무선 랜 라우터라고도한다.
	- ***ONU*** : 자택이나 회사 등에 끌어온 광 회선과 공유기 사이에 설치되어 광 회선과 공유기를 연결하고 광신호와 디지털 신호를 변환하는 장치입니다. 
	- ***라우터***: 네트워크와 네트워크를 연결한다. 랜과 인터넷의 경계에 설치되어 네트워크 간 다리를 놓거나, 거점과 거점을 연결하거나, 여러 단말기로 네트워크 회선을 공용하는 역할을 담당한다. 라우터와  L3 스위치의 차이점은
	- ***방화벽***: 라우터와 마찬가지로 네트워크 경계에 놓이는 장비로 보안과 관련된 기능을 풍부하게 갖추었다. 안티바이러스 안티스팸, 침입 감지 방어 등 역할 담당.
	- ***가상 라우터***: VPC(퍼블릭 클라우드를 가상 프라이빗 클라우드로 이용하는 기술, Virtual Private Cloud) 는 가상적인 데이터 센터로 기업 네트워크와 프라이빗 네트워크로 연결되는데 VPC쪽 연결점이 되는 것이 가상 라우터이다. 가상 라우터는 클라우드에서 실행되는 소프트웨어로 제공된다.
- 인터넷 : 네트워크와 네트워크를 연결하여 전세계적 범위의 네트워크망 형성
	- 조직 단위 (AS,  Autonomous System, 자율 시스템) : 인터넷을 구성하는 단위인 어느 하나의 관리 주체로 보유 운용 되는 독립된 네트워크를 의미한다. 여러 조직이 연결되어 인터넷이 형성되어있다. 조직의 네트워크간 접속 정책은 인터넷의 공통된 규칙을 따르지만, 조직 내부를 어떤 정책으로 운용할지는각 조직이 정한다. 예를 들어 SKT, KT, LG U+ 인터넷 서비스 제공자(ISP) 조직이 연결되어 인터넷 형성.
	- 인터넷 상에는 여러 라우터가 있고 몇 단계의 라우터를 경유해야 통신을 할 수 있다. 내 컴퓨터에서 웹사이트에 접속하면 다양한 네트워크를 거친다. ***tracert*** 명령어를 입력하면 경유한 네트워크의 IP주소를 추적하여 볼 수 있다. ```ex) tracert google.com```
- 프로토콜
	- 컴퓨터끼리 통신하기 위한 공통의 약속
	- TCP/IP
	
## TCP/IP

- TCP/IP 4 계층 모델 
```
	응용 계층:		HTTP, DNS		: 애플리케이션에 맞추어 통신한다. 
	전송 계층:		TCP, UDP		: IP와 애플리케이션을 중개하여 송신된데이터를 확실하게 전달한다.
	인터넷 계층:		IP, ICMP, ARP 	: 네트워크 주소를 기반으로 수신 측 컴퓨터까지 데이터를 전송한다. 
네트워크 접근 계층: 이더넷,무선랜,Wi-Fi : 컴퓨터를 물리적으로 네트워크에 연결하여 기기간 전송할수 있게 한다. 
```
- OSI 참조 모델
```
L7	응용			:HTTP,DNS...
L6	표현 		:HTTP,DNS...
L5	세션			:HTTP,DNS...
L4	전송			:TCP, UDP
L3	네트워크		:IP
L2	데이터링크	: 이더넷
L1	물리			: 이더넷
```
## IP 주소 구조
통신 상대를 특정하는 식별 정보
- IP주소란? TCP/IP에서 컴퓨터를 식별하려고 할당되는 번호. 컴퓨터, 모바일, 서버,라우터, 스위치등 네트워크 장비에도 각각 IP주소가 할당됨.  
	- 프라이빗 IP 주소 : 랜 내부에서 사용됨 
	- 글로벌 IP 주소 : 인터넷에서 사용됨.
- MAC 주소: 기기에 처음부터 할당된 번호인 MAC 주소와 IP주소와 조합해야지만 통신 가능. 이더넷에서는 하드웨어끼리 통신 상대를 특정하기위해 MAC주소를 사용하고, TCP/IP 에서는 통신 상대를 특정하고자 IP주소를 사용하기 때문이다. 
- ARP : 같은 네트워크 내부에서 IP 패킷을 보내고 싶은 상대의 MAC 주소를 조사할 때 이용하는 것이 ARP(Address Resolution Protocol)다. IP 주소에 대응하는 MAC 주소를 알아내려고 네트워크 전체에 패킷을 보내면(브로드캐스트), 해당 주소의 컴퓨터가 응답함으로써 MAC 주소와 IP 주소를 연결하여 통신할수 있게하는 일련의 시스템을 의미한다. 
- 다른 네트워크의 IP 주소와 통신한다면? 컴퓨터는 미리 지정된 기본 게이트웨이라는 IP 주소로 통신을 보냄. 보통 라우터가 그 역할을 수행하며, 라우터는 다른 네트워크로 데이터를 전송하는 방법을 알고 있으며 이때 ARP를 사용해서 기본 게이트웨이에 대응하는 MAC주소를 조사한다. 
- IPv4 와 IPv6 
- 패킷
	- 데이터를 패킷을 이용해 교환한다. 헤더 + 페이로드
-  IP 주소는 어떻게 설정되는가? 
- 처음에 컴퓨터는 MAC주소만 소유하고 있다. 라우터에 연결해서 IP주소를 받아와 인터넷을 사용할수 있게 되는 것이다. 
- DHCP(Dynamic Host Configuration Protocol) : 라우터에 IP주소를 자동으로 할당받는 기술
```
DHCP Discover: DHCP 클라리언트가 DHCP 서버를 찾기 위해 네트워크에 통신(브로드캐스트)
DHCP Offer	: DHCP 서버가 DHCP 클라이언트에 설정을 제안하는 통신을 한다.(요청에 응답하고 제안)
DHCP Request: DHCP 클라이언트가 DHCP 서버에 제안된 설정의 세부사항을 요청하는 통신을 한다.(브로드캐스트)
DHCP ACK	: DHCP 서버가 DHCP 클라이언트에 설정의 세부 사항을 지정하는 통신을 한다.
```
- 서브넷 마스크 : IPv4 주소에서 네트워크 부분이 어느 부분까지인지 나타냄.
- 192.168.1.2 = 네트워크 부분 + 호스트 부분(IP 주소 할당), 컴퓨터, 라우터 프린터 등에 모두 IP 주소 필요. 
- 특별한 주소로 IP 주소로 할당할 수 없음
	- 호스트부가 모두 0으로 된 것 : 네트워크 주소
	- 호스트부를 모두 1로 한 주소 : 브로드캐스트 주소 (ARP가 사용)
- CIDR 표기법 : 192.168. 1. 2 주소에서 네트워크부는 24비트이므로 네트워크주소는 192.168.1.0 이므로 192.168.1.0/24 라고 표기할 수 있다. 
- IP 주소는 네트워크부 길이에 따라 클래스를 나눌 수 있다. 
	- 클래스 A, B, C 
	- 가변 길이 서브넷 마스크 : 클래스의 서브넷 마스크 길이를 변경하여 네트워크 크기를 바꾼 것, 호스트부를 넓혀서 가용 IP 주소를 간단하게 추가로 확보할 수 도 있다.  
	- 서브넷 마스크 계산 방법
	- 네트워크 세그먼트: 한 도메인인 네트워크를 나누었을 때 물리적으로 제한되는 각각의 네트워크
- 데이터 전송 메커니즘
	- 라우팅
	- 라우팅 테이블 : 네트워크 통신을 어느 라우터로 전달해야하는지 기록되어있음. 
	- 라우터에도 기본 게이트웨이가 있어서 기본 라우터로 통신을 전송하면 기본 라우터가 다시 전송처를 찾는 식으로 버킷 릴레이를 반복하여 네트워크 성립됨. 
	- ***라우터와 L3 스위치의 차이점?***
	- 라우터는 L3 스위치보다 보안성이 강화된 장비. 
- ipconfig /all  명령어로 IP주소와 MAC 주소 확인 가능 
## 네트워크 프로토콜
- L2 스위치 : MAC 주소에 따라 데이터를 전송
- L3 스위치 : L2 + 다른 네트워크를 연결하는 기능, 많은 포트 탑재. 
	- 라우터 : 다양한 회선 수용 가능(전화선, 광 회선 등), L3 스위치 보다 보안이 뛰어남. 
- L4, L7 스위치: 로드밸런서 (로드밸런싱: 시스템에 대한 요청을 여러 서버에 분산해서 통신량의 균형을 조절하는 기술)
	- L4 : TCP 헤더 등 프로토콜의 헤더 내용을 해석하고 지정된 알고리즘에 근거하여 데이터를 분산해서 전송, 라운드 로빈, 최소 연결 배분 방식을 주로 사용. 
	- L7 : L4 에 더해 응용 계층의 내용까지 분석하여 데이터를 분산해서 전송한다. 특정 사용자와 세션을 유지하는 기능을 실현, 복수의 서버 환경에서 다른 서버에 연결되더라도 불일치가 발생하지 않도록 한다. 
- TCP, UDP
- OSI 모델 4계층에서 동작하는 프로토콜로 IP(3계층)와 애플리케이션을 중개한다. 
	- TCP : 신뢰할 수 있는 통신을 보장
	- UDP : TCP 보다 빠르지만 신뢰성 확보를 위한 기능이 없음. 
- 포트 번호 : 같은 서버내의 애플리케이션 특정
	- well-known port : 0~1023 이미 사용중인 포트가 많으므로 사용하지 않는게 좋음
	- registered port : 1024~ 49151 
	- dynamic port 동적 포트 번호,  49152 ~ 65535 : 클라이언트 측에서 사용하는 포트 번호 동적으로 할당됨. 동적으로 출발지 포트를 할당해서 웹 브라우저 2개를 동시에 실행할 때 구분할 수 있다. 
- ICMP( Internet Control Message Protocol)
	- TCP/IP 가 구현된 컴퓨터 및 네트워크 기기 사이에서 통신 상태를 확인할 때 이용하는 프로토콜
	- OSI 3계층에서 동작, IP 위에서 동작하하는 프로토콜
	- ping, tracert 명령어를 사용시 이 프로토콜 사용
	- ICMP는 TCP/IP, UDP와 동등한 위치에 있는 프로토콜로 TCP나 UDP를 거치지 않고 동작하므로 포트번호가 없다. 
- NAT(Network Address Translation) : IP주소를 변환하는 기술
	- 프라이빗 IP 주소로는 인터넷상에서 라우팅 할수 없으므로 글로벌 IP 주소로 변환해야만 데이터를 전송할 수 있다. 
	- 프라이빗 IP 주소 : 랜 내에서만 사용됨.
		- 클래스 A 	10.0.0.0/8
		- 클래스 B	172.16.0.0/12
		- 클래스 C	192.168.0.0/16 
- CIDR (Classless Inter-Domain Routing) : 라우팅을 모아서 쓴다. (라우팅 테이블 공간절약)
- 라우팅 테이블 정보 관리
	- 정적 라우팅 : 네트워크 구축 및 변경시 라우팅 테이블을 사람이 수동으로 관리.
	- 동적 라우팅 : 정기적으로 라우터끼리 정보를 교환하여, 이를 바탕으로 라우팅 테이블을 자동으로 설정한다.(라우팅 프로토콜)
## 도메인
- 웹
	- 클라이언트 - 서버 모델
	- 웹서버 Apache, Nginx
	- HTTPS
		- SSL/TLS : 통신을 암호화, 현재 TLS 프로토콜 사용됨
		- SSL 인증서 : 신뢰할 수 있는 인증기관이 도메인 소유자에게 발행하여 SSL/TLS 사용
			- 데이터 암호화 : 공개키 +  비밀키
			- 도메인 소유 증명 : 소유 보증 역할
			- 데이터 변조 방지
		- 인증 레벨
			- 도메인 인증 : 도메인 소유만 확인, 간편, 민감정보를 주고 받지 않을때 주로 간편하게 사용함. 
			- 기업 인증 : 도메인 소유 + 운영 조직 실재 인증, 민감 정보를 주고 받을 때 사용. 
			- EV 인증  : 소재지까지 인증, 뱅킹 , 핀테크에서 주로 사용되는 가장 엄격한 레벨의 인증
	- URL : 인터넷상에서 이미지, html 리소스 위치를 특정할 수 있는 서식
		- 스킴(프로토콜 +://) + 주소(호스트+도메인) + 디렉토리명 + 파일명 
		- ```ex)https://90.158.155.34/news/today.html```
	- DNS : IP 주소를 호스트 이름(```www```)과 도메인(```aaa.com```)으로 바꾸어 사용하기 쉽게 한다. DNS는 호스트 이름과 도메인으로 IP 주소를 조회할 수 있는 시스템이다. 
		- ```https://www.aaa.com/news/today.html``` 
		- 콘텐츠 DNS 서버와 캐시 DNS 서버로 구성됨
		- 콘텐츠 DNS 서버는 각 도메인의 기본 정보를 가지고 있고 캐시 DNS 서버는 클라이언트의 문의가 들어오면 콘텐츠 DNS 서버를 찾아서 정보를 요청하고 응답받은 정보를 클라이언트에게 전달한다. 
```
nslookup www.google.com 을 실행시  

권한 없는 응답:
이름:    www.google.com
Addresses:  2404:6800:400a:80a::2004
	        172.217.25.164
```
*추가로 Addresses가 여러개 나오는 것은 DNS 라운드로빈 부하분산 시스템으로 IP주소를 교대로 반환해서 접속을 분산한다. 

- 도메인
	-  도메인이란? 인터넷상의 주소로 글로벌 IP주소를 가진 서버가 어디있는지 판단하는 정보로 이용된다. 
	- 관리기관: ICANN (비영리단체), 레지스트리(도메인관리기관), 레지스트라(도메인 중개등록업체)
	- gTLD : 글로벌 탑 레벨의 도메인
	- ccTLD: 국가코드 탑 레벨 도메인 우리나라 .kr, 한국인터넷진흥원이 레즈스트리로 운영중이며, 레지스트라로 가비아 아이네임즈 등이있다. 
	- IP주소 변경시 DNS 설정도 변경해야한다.  얼마나 오래 주소 정보를 캐시로 보관할지는 콘텐츠 DNS 서버의 원본 데이터에 정의되어 있다. 
- HTTP
	- 웹브라우저와 웹서버 간의 상호 작용을 지원하는 프로토콜
	- 상태코드, 헤더, 메시지로 응답 처리 결과를 나타낸다. 
	- 데이터를 요청하고 전송하는 데 상태를 저장하지 않는 프로토콜
	- 쿠키, 세션
	- HTTP/2 는 커넥션을 연결해 복수 컨텐츠를 병렬로 전송할 수 있다. 
	- Ajax : XMLHttpRequest 기술 사용
	- 웹 소켓 : 서버측과 양방향 통신
## 네트워크 장비: 라우터, 스위치...
- 라우터
- 네트워크와 네트워크를 연결
- 회선 1개를 공유하여 여러대의 기기 동시 사용가능
- DHCP 서버 기능이 있어서 정해진 범위 안에서 컴퓨터에 IP 주소를 충돌이 일어나지 않게 할당하여 관리 
- 스위치 
	- L7 스위치: 라우터의 기능에 더해 응용 계층의 내용까지 해석해서 데이터를 배분. 
		- 특정 사용자와 서버의 연결(세션)을 유지하는 기능을 구현
- 방화벽, UTM : 3,4계층 수준에서 방어하는 기본적인 보안 시스템
- WAF: 웹사이트 앞쪽에 배치하여 공격 방지하는 보안대책, SQL인젝션 , 크로스사이트 스크립팅, 패스워드 리스트 공격을 방어
- IDS/IPS 


